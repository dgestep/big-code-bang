import {Injectable} from "@angular/core";
import {Response} from "@angular/http";
import {ServiceResults} from "./service.results";
import {ServiceError} from "./service.error";
import {ResponseMessage} from "./response.message";
import {ALERT_DANGER} from "./constants";

@Injectable()
export class ServiceHelperService {

    /**
     * Returns the data returned from a service call.
     *
     * @param res the HTTP response.
     * @returns {any} the data.
     */
    extractData(res: Response): Object {
        let body = res.json();
        if (body.statusCode === 200) {
            return new ServiceResults(body.data);
        } else {
            return new ServiceError(body.messages);
        }
    }

    /**
     * Handles service calls that resulted in a non successful response.
     *
     * @param error the HTTP response containing the error information.
     * @returns {ResponseMessage[]|[{}]} the error messages.
     */
    handleError(error: Response) {
        let status = error.status;
        let msg = "Status code: " + status + " Status Text: " + error.statusText;
        let errMsgs = new Array<ResponseMessage>();
        errMsgs.push(new ResponseMessage(msg, ALERT_DANGER));

        return errMsgs || [{}];
    }
}